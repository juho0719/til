
### Cloud9을 위한 IAM 역할 생성
- IAM - 역할 - 역할 만들기
![[Pasted image 20230418000108.png]]
- AWS 서비스 선택
- EC2 선택
![[Pasted image 20230418000230.png]]
- `AdministratorAccess` 선택
![[Pasted image 20230418000353.png]]
- 역할 이름 작성 (여기서는 eksworkshop-admin)
![[Pasted image 20230418000625.png]]
- 역할 생성 버튼 클릭
![[Pasted image 20230418000501.png]]


### Cloud9 권한 설정
- AWS서비스에서 EC2 선택
- EC2 대쉬보드의 인스턴스에서 Cloud9 EC2 인스턴스 선택
- 우측 상단의 작업 - 보안 - IAM 역할 수정
![[Pasted image 20230418001008.png]]
- 앞서 생성한 `eksworkshop-admin`을 선택 하고 업데이트
![[Pasted image 20230418001057.png]]


### 기존자격 증명 파일 제거
- Cloud9의 기존 자격증명과 임시 자격 증명 등을 비활성화
- Cloud9에서 우측 상단 톱니바퀴 모양 클릭
- AWS Settings - AWS managed temporary credentials 비활성화
![[Pasted image 20230418001737.png]]
- Cloud9 터미널에서 임시 자격 증명을 사용하지 않도록 기존 자격 증명 제거
```sh
rm -vf ${HOME}/.aws/credentials
```


### Cloud9 IDE 역할 점검
- Cloud9이 올바른 IAM 역할을 하고 있는지 확인
- 실제 Role의 Arn은 아래 명령을 통해 확인 가능
```sh
aws sts get-caller-identity --region ap-northeast-2 --query Arn | grep eksworkshop-admin -q && echo "IAM role valid" || echo "IAM role NOT valid"
aws sts get-caller-identity --region ap-northeast-2
```


